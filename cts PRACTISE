CREATE TABLE EMPLOYEES(
    EMPID INT PRIMARY KEY,
    EMPNAME VARCHAR(30),
    DEPARTMENT VARCHAR(15),
    SALARY INT
);

CREATE TABLE DEPARTMENTS(
    DEPARTMENTID INT PRIMARY KEY,
    DEPARTMENTNAME VARCHAR(30)
);
INSERT INTO EMPLOYEES(EMPID, EMPNAME, DEPARTMENT, SALARY) VALUES
(1, 'RAHUL', 'IT', 75000),
(2, 'PRIYA', 'HR', 55000),
(3, 'ARJUN', 'FINANCE', 60000),
(4, 'SNEHA', 'IT', 48000),
(5, 'KIRAN', 'SALES', 67000),
(6, 'MEENA', NULL, 50000);
INSERT INTO DEPARTMENTS(DEPARTMENTID, DEPARTMENTNAME) VALUES
(101, 'IT'),
(102, 'HR'),
(103, 'FINANCE'),
(104, 'SALES'),
(105, 'MARKETING');


SELECT EMPID,EMPNAME,DEPARTMENT, SALARY 
FROM EMPLOYEES

WHERE DEPARTMENT='IT' AND SALARY>50000
ORDER BY SALARY desc
LIMIT 1;

SELECT E.EMPNAME,D.DEPARTMENTNAME
FROM EMPLOYEES AS E 
LEFT JOIN DEPARTMENTS AS D 
ON E.DEPARTMENT=D.DEPARTMENTNAME;

SELECT EMPNAME,SALARY,AVG(SALARY) AS AVERAGESALARY
FROM EMPLOYEES
GROUP BY EMPNAME,SALARY
HAVING AVG(SALARY)>60000;

SELECT EMPNAME
FROM EMPLOYEES
WHERE SALARY>ALL(SELECT AVG(SALARY) FROM EMPLOYEES);
